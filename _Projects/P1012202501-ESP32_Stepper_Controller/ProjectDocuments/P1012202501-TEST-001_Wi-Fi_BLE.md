### Test Case: TEST-002 — Wi-Fi and BLE Provisioning Validation

**Test ID:** TEST-001  
**Title:** ESP32 Wireless Provisioning and BLE Performance Test  
**Owner:** Firmware Lead  
**Version:** 1.0  
**Date Created:** 2025-11-01  
**Linked Requirements:** FR-001, FR-005, PR-002  
**Linked Design Element:** ESP32 module; net: ESP32_WIFI_EN, ESP32_BLE_EN  
**Linked Verification Plan:** MDL-010_Test_Plan.md  
**Traceability Matrix Entry:** FR-001 → ESP32_WIFI_EN → TEST-001 → ./test-logs/TEST-001_Wireless.csv

---

### Objective

Verify that the ESP32 module can successfully provision Wi-Fi credentials over BLE and connect to a network within the target time, while maintaining BLE stability and responsiveness.

---

### Test Setup

| Item | Description |
| --- | --- |
| PCB Revision | magic-kit_V1.0 |
| Firmware Version | FW_V0.9.2 (BLE + Wi-Fi provisioning enabled) |
| BLE Client | Android phone running test app (BLE Provisioner v1.2) |
| Wi-Fi Network | 2.4 GHz WPA2 secured network (SSID: DevNet, Password: test1234) |
| Measurement Tools | BLE log capture, Wi-Fi ping test, stopwatch |
| Environment | Indoor lab, 22 °C, no RF shielding |

---

### Procedure

1. Power board and confirm ESP32 boots into BLE provisioning mode.  
2. Scan for BLE device using mobile app and initiate connection.  
3. Send Wi-Fi credentials via BLE GATT characteristic.  
4. Wait for ESP32 to connect to Wi-Fi and report IP address.  
5. Ping ESP32 from host PC to confirm network presence.  
6. Repeat provisioning 5 times with different SSIDs.  
7. Log BLE connection time, provisioning time, and Wi-Fi response.  
8. Monitor BLE stability during provisioning and post-connect.

---

### Pass/Fail Criteria

| Metric | Target | Pass Criteria |
| --- | --- | --- |
| BLE connection time | < 5 s | BLE client connects in under 5 seconds |
| Provisioning time | < 10 s | Wi-Fi credentials accepted and IP assigned in under 10 seconds |
| BLE stability | No disconnects | BLE remains connected during provisioning |
| Wi-Fi response | < 100 ms ping | ESP32 responds to ping with < 100 ms latency |

---

### Results Summary

| Trial | BLE Connect (s) | Provisioning (s) | Ping (ms) | BLE Stability | Pass/Fail |
| --- | --- | --- | --- | --- | --- |
| 1 | 3.2 | 8.1 | 42 | Stable | Pass |
| 2 | 2.9 | 7.8 | 38 | Stable | Pass |
| 3 | 3.5 | 9.2 | 45 | Stable | Pass |
| 4 | 3.1 | 8.5 | 40 | Stable | Pass |
| 5 | 3.0 | 8.0 | 39 | Stable | Pass |

**Notes:**  
- All trials completed within target thresholds.  
- BLE remained stable throughout; no disconnects or retries.  
- Recommend adding visual indicator (LED blink) for provisioning status.

---

### Attachments

- `/test/test-logs/TEST-002_Wireless.csv`  
- BLE log screenshots  
- Wi-Fi ping results  
- Firmware provisioning code snippet (BLE GATT handler)

---

### Approval

| Name | Role | Signature | Date |
| --- | --- | --- | --- |
| Firmware Lead | Test Owner | _[signed]_ | 2025-11-01 |
| QA Lead | Reviewer | _[signed]_ | 2025-11-01 |